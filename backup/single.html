{{ define "main" }}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
    <!-- Stock Header -->
    <div class="mb-8">
        <h1 class="text-3xl font-bold text-gray-900">{{ .Title }}</h1>
        <p class="mt-2 text-gray-600">{{ .Description }}</p>
        
        <!-- Stock Metadata -->
        <div class="mt-4 flex flex-wrap gap-2">
            {{ range .Params.sectors }}
                <span class="px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800">
                    {{ . }}
                </span>
            {{ end }}
            {{ range .Params.market_caps }}
                <span class="px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800">
                    {{ . }}
                </span>
            {{ end }}
            {{ range .Params.risk_levels }}
                <span class="px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800">
                    {{ . }}
                </span>
            {{ end }}
        </div>
    </div>

    <!-- TradingView Widgets Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- Advanced Chart Widget -->
        <div class="lg:col-span-2 bg-white rounded-lg shadow-sm p-4 h-[600px]">
            <div class="tradingview-widget-container h-full">
                <div id="tradingview_chart" class="h-full"></div>
                <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
                <script type="text/javascript">
                window.addEventListener('DOMContentLoaded', function() {
                    new TradingView.widget({{ merge $.Site.Data.stock_chart (dict "symbol" (index .Params.stocks 0) "container_id" "tradingview_chart") | jsonify | safeJS }});
                });
                </script>
            </div>
        </div>

        <!-- Technical Analysis Widget -->
        <div class="bg-white rounded-lg shadow-sm p-4 h-[400px]">
            <div class="tradingview-widget-container h-full">
                <div class="tradingview-widget-container__widget h-full"></div>
                <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-technical-analysis.js" async>
                {{ merge $.Site.Data.technical_analysis (dict "symbol" (index .Params.stocks 0)) | jsonify | safeJS }}
                </script>
            </div>
        </div>

        <!-- Company Profile Widget -->
        <div class="bg-white rounded-lg shadow-sm p-4 h-[400px]">
            <div class="tradingview-widget-container h-full">
                <div class="tradingview-widget-container__widget h-full"></div>
                <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-symbol-profile.js" async>
                {{ merge $.Site.Data.widgets.symbol_profile (dict "symbol" (index .Params.stocks 0)) | jsonify | safeJS }}
                </script>
            </div>
        </div>

        <!-- Fundamental Data -->
        <div class="lg:col-span-2 bg-white rounded-lg shadow-sm p-4 h-[500px]">
            <div class="tradingview-widget-container h-full">
                <div class="tradingview-widget-container__widget h-full"></div>
                <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-financials.js" async>
                {{ merge $.Site.Data.widgets.financials (dict "symbol" (index .Params.stocks 0)) | jsonify | safeJS }}
                </script>
            </div>
        </div>
    </div>

    <!-- Stock Content -->
    <div class="mt-8 prose max-w-none">
        {{ .Content }}
    </div>
</div>
{{ end }} 